---
layout: layouts/base.njk
permalink: /courses/index.html
currentLang: zh-TW
---
{% import "macros/i18n.njk" as i18nMacro %}

<div data-pagefind-ignore>
<div class="flex items-center justify-between gap-4 mb-6">
  <h1 class="text-2xl md:text-3xl font-semibold">{{ i18n[currentLang].nav.courses }}</h1>
  <!-- Search Bar with Icon -->
  <div class="search-input-wrapper">
    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
    </svg>
    <input
      type="text"
      id="searchInput"
      class="search-input"
      placeholder="{{ i18n[currentLang].filters.search_placeholder }}"
      data-i18n-placeholder="filters.search_placeholder"
    >
  </div>
</div>

<!-- Results Count -->
<div id="resultsCount" class="results-count" data-i18n-template="filters.showing_results"></div>

<!-- Responsive Layout: Mobile (top) / Desktop (sidebar + main) -->
<div class="courses-container">
  <!-- Filter Panel -->
  <aside class="filter-panel" id="filterPanel">
    <div class="filter-panel-content">
      <h2 class="filter-panel-title" data-i18n="filters.grade_filter">{{ i18n[currentLang].filters.grade_filter }}</h2>
      <select id="gradeFilter" class="filter-select">
        <option value="all" data-i18n="filters.all_grades">{{ i18n[currentLang].filters.all_grades }}</option>
      </select>

      <h2 class="filter-panel-title" data-i18n="filters.domain_filter">{{ i18n[currentLang].filters.domain_filter }}</h2>
      <select id="domainFilter" class="filter-select">
        <option value="all" data-i18n="filters.all_domains">{{ i18n[currentLang].filters.all_domains }}</option>
      </select>

      <h2 class="filter-panel-title" data-i18n="filters.teacher_filter">{{ i18n[currentLang].filters.teacher_filter }}</h2>
      <select id="teacherFilter" class="filter-select">
        <option value="all" data-i18n="filters.all_teachers">{{ i18n[currentLang].filters.all_teachers }}</option>
      </select>

      <button id="resetFilters" class="reset-filters-btn" data-i18n="filters.reset_filters">{{ i18n[currentLang].filters.reset_filters }}</button>
    </div>
  </aside>

  <!-- Main Content Area -->
  <div class="courses-main">
    <!-- Course Cards Grid -->
    <div id="coursesGrid" class="home-course-grid">
      {% for c in coursesList %}
      <article
        class="course-card home-course-card"
        data-course-slug="{{ c.slug }}"
        data-course-i18n="{{ c.i18n | json }}"
        data-grade="{{ c.metadata.grade_level if c.metadata else '' }}"
        data-domain="{{ c.metadata.domain_category if c.metadata else '' }}"
        data-teacher="{{ c.metadata.teacher_name if c.metadata else '' }}"
      >
        {# Hidden English content for Pagefind indexing #}
        {% if c.i18n and c.i18n['en-US'] %}
        <div style="position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden;" aria-hidden="true" lang="en-US">
          {{ c.i18n['en-US'].title }}
          {{ c.i18n['en-US'].grade }} {{ c.i18n['en-US'].semester }}
          {{ c.i18n['en-US'].unit }} {{ c.i18n['en-US'].domain }}
          {{ c.i18n['en-US'].overview }}
        </div>
        {% endif %}
        {% set courseDescriptionDoc = materialHelpers.getDoc(c, 'course_description') %}
        {% set hasWorkbook = materialHelpers.hasMaterial(c, 'workbook_photos') or materialHelpers.hasMaterial(c, 'workbook_pdfs') %}
        {% set hasSyllabus = materialHelpers.hasMaterial(c, 'syllabus') %}
        {% set hasWorksheet = materialHelpers.hasMaterial(c, 'worksheet') %}
        {% set hasBlackboard = materialHelpers.hasMaterial(c, 'blackboard') %}
        {% set hasPhotos = materialHelpers.hasMaterial(c, 'photos') %}
        {% set hasPlayScript = materialHelpers.getDoc(c, 'play_script') or materialHelpers.hasMaterial(c, 'play_scripts') %}
        {% set hasScripts = materialHelpers.hasMaterial(c, 'scripts_photos') %}
        {% set hasSongs = materialHelpers.hasMaterial(c, 'songs_audio') %}
        {% set hasSheetMusic = materialHelpers.hasMaterial(c, 'sheet_music') %}
        {% set hasStory = materialHelpers.getDoc(c, 'story') %}
        {% set hasVideos = materialHelpers.hasMaterial(c, 'videos') %}
        {% set hasAnyMaterials = courseDescriptionDoc or hasWorkbook or hasSyllabus or hasWorksheet or hasBlackboard or hasPhotos or hasPlayScript or hasScripts or hasSongs or hasSheetMusic or hasStory or hasVideos %}
        <a class="course-card-link" href="{{ ('/courses/' + c.slug + '/') | url }}" aria-label="{{ i18nMacro.cf(c, 'title', currentLang) }}">
          <div class="home-card-header">
            <div class="home-card-meta">
              <span data-i18n-course="grade">{{ i18nMacro.cf(c, 'grade', currentLang) }}</span>
              <span aria-hidden="true">•</span>
              <span data-i18n-course="semester">{{ i18nMacro.cf(c, 'semester', currentLang) }}</span>
              <span aria-hidden="true">｜</span>
              <span data-i18n-course="unit">{{ i18nMacro.cf(c, 'unit', currentLang) }}</span>
              <span aria-hidden="true">•</span>
              <span data-i18n-course="domain">{{ i18nMacro.cf(c, 'domain', currentLang) }}</span>
            </div>
            <h2 class="home-card-title">
              <span data-i18n-course="title">{{ i18nMacro.cf(c, 'title', currentLang) }}</span>
            </h2>
          </div>
          <div class="home-card-body">
            <p data-i18n-course="overview">{{ i18nMacro.cf(c, 'overview', currentLang) or '' }}</p>
          </div>
          {% if c.tags and c.tags.length %}
          <div class="home-tag-list">
            {% for tag in c.tags.slice(0, 3) %}
            <span class="home-tag-pill">#{{ tag }}</span>
            {% endfor %}
          </div>
          {% endif %}
        </a>
        {% if hasAnyMaterials %}
        <div class="course-material-labels">
          {% if courseDescriptionDoc %}
          <a href="{{ ('/courses/' + c.slug + '/') | url }}" class="course-material-label">{{ i18n[currentLang].course.course_home }}</a>
          {% endif %}
          {% if hasWorkbook %}
          <a href="{{ ('/courses/' + c.slug + '/workbook/') | url }}" class="course-material-label">{{ i18n[currentLang].course.workbook }}</a>
          {% endif %}
          {% if hasSyllabus %}
          <a href="{{ ('/courses/' + c.slug + '/syllabus/') | url }}" class="course-material-label">{{ i18n[currentLang].course.syllabus }}</a>
          {% endif %}
          {% if hasWorksheet %}
          <a href="{{ ('/courses/' + c.slug + '/worksheet/') | url }}" class="course-material-label">{{ i18n[currentLang].course.worksheet }}</a>
          {% endif %}
          {% if hasBlackboard %}
          <a href="{{ ('/courses/' + c.slug + '/blackboard/') | url }}" class="course-material-label">{{ i18n[currentLang].course.blackboard_drawings }}</a>
          {% endif %}
          {% if hasPhotos %}
          <a href="{{ ('/courses/' + c.slug + '/photos/') | url }}" class="course-material-label">{{ i18n[currentLang].course.photo_gallery }}</a>
          {% endif %}
          {% if hasPlayScript %}
          <a href="{{ ('/courses/' + c.slug + '/play-script/') | url }}" class="course-material-label">{{ i18n[currentLang].course.play_script }}</a>
          {% endif %}
          {% if hasScripts %}
          <a href="{{ ('/courses/' + c.slug + '/scripts/') | url }}" class="course-material-label">{{ i18n[currentLang].course.performance }}</a>
          {% endif %}
          {% if hasSongs %}
          <a href="{{ ('/courses/' + c.slug + '/songs/') | url }}" class="course-material-label">{{ i18n[currentLang].course.songs }}</a>
          {% endif %}
          {% if hasSheetMusic %}
          <a href="{{ ('/courses/' + c.slug + '/sheet-music/') | url }}" class="course-material-label">{{ i18n[currentLang].course.sheet_music }}</a>
          {% endif %}
          {% if hasStory %}
          <a href="{{ ('/courses/' + c.slug + '/story/') | url }}" class="course-material-label">{{ i18n[currentLang].course.story }}</a>
          {% endif %}
          {% if hasVideos %}
          <a href="{{ ('/courses/' + c.slug + '/videos/') | url }}" class="course-material-label">{{ i18n[currentLang].course.video }}</a>
          {% endif %}
        </div>
        {% endif %}
      </article>
      {% endfor %}
    </div>

    <!-- No Results Message -->
    <div id="noResults" class="no-results hidden">
      <p>{{ i18n[currentLang].filters.no_results }}</p>
    </div>
  </div>
</div>
</div>

<!-- Load filter script -->
<script src="{{ '/js/course-filters.js' | url }}" defer></script>
